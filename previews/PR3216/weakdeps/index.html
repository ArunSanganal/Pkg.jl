<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Weak dependencies · Pkg.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://julialang.github.io/Pkg.jl/v1/weakdeps/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Pkg.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">Pkg.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../"><strong>1.</strong> Introduction</a></li><li><a class="tocitem" href="../getting-started/"><strong>2.</strong> Getting Started</a></li><li><a class="tocitem" href="../managing-packages/"><strong>3.</strong> Managing Packages</a></li><li><a class="tocitem" href="../environments/"><strong>4.</strong> Working with Environments</a></li><li><a class="tocitem" href="../creating-packages/"><strong>5.</strong> Creating Packages</a></li><li class="is-active"><a class="tocitem" href>Weak dependencies</a><ul class="internal"><li><a class="tocitem" href="#Compatibility-with-older-Julia-versions."><span>Compatibility with older Julia versions.</span></a></li></ul></li><li><a class="tocitem" href="../compatibility/"><strong>6.</strong> Compatibility</a></li><li><a class="tocitem" href="../registries/"><strong>7.</strong> Registries</a></li><li><a class="tocitem" href="../artifacts/"><strong>8.</strong> Artifacts</a></li><li><a class="tocitem" href="../glossary/"><strong>9.</strong> Glossary</a></li><li><a class="tocitem" href="../toml-files/"><strong>10.</strong> <code>Project.toml</code> and <code>Manifest.toml</code></a></li><li><a class="tocitem" href="../repl/"><strong>11.</strong> REPL Mode Reference</a></li><li><a class="tocitem" href="../api/"><strong>12.</strong> API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Weak dependencies</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Weak dependencies</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaLang/Pkg.jl/blob/master/docs/src/weakdeps.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Weak-dependencies"><a class="docs-heading-anchor" href="#Weak-dependencies">Weak dependencies</a><a id="Weak-dependencies-1"></a><a class="docs-heading-anchor-permalink" href="#Weak-dependencies" title="Permalink"></a></h1><p>It is sometimes desirable to be able to extend some functionality of a package without having to unconditionally take on the cost (in terms of e.g. load time) of adding an extra dependency. A <em>weak</em> dependency is a package that is only available to load if some other package in the current environment have that package as a normal (or strong) dependency. </p><p>Weak dependencies are listed in a <code>Project.toml</code> file under the <code>[weakdeps]</code> section which can be compared to a (strong) dependency which is under the <code>[deps]</code> section. Compatibility on weak dependencies are specified like a normal dependeny unde the ´[compat]` section.</p><p>A useful application of weak dependencies could be for a plotting package that should be able to plot objects from different Julia packages. Adding all those different Julia packages as dependencies could be expensive. Instead, these packages are added as weak dependencies so that they are available only if there is a chance that someone might call the function with such a type.</p><p>Below is an example of how the code can be structured for a use-case as outlined above.</p><p><code>Project.toml</code>:</p><pre><code class="language-toml hljs">name = &quot;Plotting&quot;
version = &quot;0.1.0&quot;
uuid = &quot;...&quot;

[deps] # strong dependencies
Colors = &quot;5ae59095-9a9b-59fe-a467-6f913c188581&quot;

[weakdeps]
Contour = &quot;d38c429a-6771-53c6-b99e-75d170b6e991&quot;

[compat] # compat can also be given on weak dependencies
Colors = &quot;0.12.8&quot;
Contour = &quot;0.6.2&quot;</code></pre><p><code>src/Plotting.jl</code>:</p><pre><code class="language-julia hljs">module Plotting

using Colors

if Base.@hasdep Contour
    using Contour
    function plot(c::Contour.ContourCollection
         ...
    end
end

end # module</code></pre><h2 id="Compatibility-with-older-Julia-versions."><a class="docs-heading-anchor" href="#Compatibility-with-older-Julia-versions.">Compatibility with older Julia versions.</a><a id="Compatibility-with-older-Julia-versions.-1"></a><a class="docs-heading-anchor-permalink" href="#Compatibility-with-older-Julia-versions." title="Permalink"></a></h2><p>It is possible to have a dependency be a weak version in Julia versions that support it and be a strong dependency in earlier Julia versions. This is done by having the dependency as <em>both</em> a strong and weak dependency. Older Julia version will ignore the specificaton of the depenency as weak while new Julia versions will tag it as a weak dependency.</p><p>The above code would then look like:</p><pre><code class="language-julia hljs">module Plotting

using Colors

if !isdefined(Base, :hasdep) || Base.hasdep(@__MODULE__, :Contour)
    using Contour
    function plot(c::Contour.ContourCollection
         ...
    end
end

end # module</code></pre><p>where the &quot;conditional code&quot; is executed unconditionally on old Julia versions and based on the presence of the weak dependency on new Julia version. Here the functional form of <code>@hasdep</code> was used which requires a module as the first argument.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../creating-packages/">« <strong>5.</strong> Creating Packages</a><a class="docs-footer-nextpage" href="../compatibility/"><strong>6.</strong> Compatibility »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Tuesday 4 October 2022 07:28">Tuesday 4 October 2022</span>. Using Julia version 1.9.0-DEV.1503.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
